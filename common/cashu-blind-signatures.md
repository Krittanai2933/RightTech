---
icon: money-bill-simple
---

# ไขกลไก Cashu กับ Blind Signaturesฅ

Cashu เป็นโปรโตคอล **Chaumian e‑cash** รูปแบบใหม่ ที่สามารถทำงานร่วมกันได้ กับบิตคอยน์ และออกแบบให้เป็น “เหรียญดิจิทัล” แบบ bearer token คล้ายกับเงินสดจริง ๆ ซึ่งระบบนี้เป็น open-source โดยทุกคนสามารถรัน mint (ในบริบทนี้ทำหน้าที่เหมือนโรงกษาปณ์ดิจิทัล) ของตนเองได้ [\[1\]](https://cashu.space/) ซึ่งเปรียบเสมือนธนาคารรายย่อยที่จะออกเหรียญ e-cash ให้กับผู้ฝากเงิน ผู้ใช้งานไม่ต้องสร้างบัญชีหรือให้ข้อมูลส่วนตัวใด ๆ กับ mint ซึ่งหมายความว่า mint จะ**ไม่ทราบยอดเงินหรือประวัติการใช้จ่ายของผู้ใช้** ทำให้เพิ่มความเป็นส่วนตัวและลดความเสี่ยงจากการรั่วไหลของข้อมูล&#x20;

ระบบ Cashu ประกอบด้วยสองส่วนหลักคือ **mint** และ **wallet** ผู้ใช้ฝากบิตคอยน์ให้กับ mint รายใดรายหนึ่ง (โดยทั่วไปจะโอนไปผ่าน Lightning Network) แล้วฝั่ง mint จะออกโทเค็น e-cash ให้ตามมูลค่าที่ฝาก ผู้ใช้สามารถถือโทเค็นนี้ไว้แล้วใช้จ่ายได้ทันทีโดยไม่ต้องผ่า on-chain และการจ่ายภายใน mint เดียวกันจะเกิดขึ้นทันทีและเกือบไม่มีค่าธรรมเนียม

<figure><img src="../.gitbook/assets/image (18).png" alt=""><figcaption></figcaption></figure>

รูปข้างต้นคือ กระบวนการทำธุรกรรมพื้นฐานของ Cashu  ที่เริ่มจากการที่ผู้ใช้ฝาก Bitcoin ให้ mint ผ่าน Lightning Network แล้ว mint ออกโทเค็น e‑cash ให้ตามมูลค่า จากนั้นผู้ใช้สามารถส่งโทเค็นนี้ให้ผู้อื่นในมินท์เดียวกันได้ทันทีโดยไม่มีค่าธรรมเนียม หรือจะถอนโทเค็นกลับมาเป็น Bitcoin ผ่าน Lightning ก็ได้

### หลักการทำงานแบบ Chaumian e‑cash

Cashu ใช้หลักการ **blind signatures** ซึ่งเป็นนวัตกรรมสำคัญของ David Chaum ในระบบ e-cash แบบดั้งเดิม [\[2\]](https://blog.cashu.space/buckets-of-blind-signatures/) เพื่อรักษาความไม่เชื่อมโยงระหว่างการออกเหรียญกับการใช้จ่าย กล่าวคือฝั่ง mint จะทำการเซ็น Digital signature ลงบน secret message ของผู้ใช้ โดยที่ไม่รู้เนื้อหาข้อความนั้น เมื่อถอดรหัสออกมาแล้วผู้ใช้จะได้โทเค็นที่มีลายเซ็นถูกต้องแต่ mint ก็ไม่สามารถเชื่อมโยงได้ว่าผู้ใช้คนใดเป็นผู้ถือโทเค็นนั้น

ขั้นตอนคร่าวๆ ของการทำงานมีดังนี้

1. ผู้ใช้เลือกจำนวนสุ่ม `x` และคำนวณจุดบน elliptic curve ให้เป็น `Y = hash_to_curve(x)` จากนั้นใช้ค่า blinding factor `r` เพื่อสร้างข้อความลับ `B = Y + rG` แล้วส่ง `B` ไปให้ mint
2. mint มี private key `k_a` สำหรับจำนวนเงิน `a` แต่ละค่า (เช่น 1 sats, 2 sats, 4 sats, …) ทำการคูณ `k_a * B` ซึ่งเป็นการเซ็นต์บนข้อความลับ แล้วคืนค่าเป็น (ผลลัพธ์ `C' = k_a * B`) ให้กับผู้ใช้
3. ผู้ใช้ถอดรหัสโดยคำนวณ `C = C' - r K` (ที่ `K = k_a G` คือ public key ของ mint) จะได้ลายเซ็นต์บนข้อมูลเดิม `Y` เป็น `C = k_a * Y` ซึ่งเชื่อมโยงกับ `x`
4. โทเค็นสุดท้ายของผู้ใช้คือคู่ `(x, C, a)` โดย `a` ระบุมูลค่าของเหรียญ (หน่วยเป็น satoshi) การจัดเก็บหมายเลข `x` ทำให้สามารถตรวจสอบการใช้ซ้ำได้ หากมีใครพยายามนำเหรียญ (ค่า `x`) เดิมมาใช้ซ้ำ mint จะตรวจพบและปฏิเสธทันที
5. เมื่อผู้ถือโทเค็นต้องการโอนให้แก่ผู้อื่น (หรือคืนให้ mint เพื่อขอ Bitcoin คืน) ก็จะส่ง `(x, C, a)` ไปให้ mint แล้ว mint จะยืนยันลายเซ็นด้วยการตรวจสอบว่าค่า `C` ตรงกับ `k_a * hash_to_curve(x)` มั้ย หากถูกต้องและ `x` ยังไม่ถูกใช้มาก่อน จึงรับรองว่าเหรียญถูกต้อง (และบันทึก `x` ไว้ในฐานข้อมูลที่ใช้แล้ว)

ระบบ Cashu กำหนดให้มีเพียงชุดมูลค่าที่จำกัด (เช่น 1, 2, 4, 8, 16 sats เป็นต้น) เพื่อเพิ่มความเป็นส่วนตัว เมื่อมีการถอนหรือต้องการจำนวนอื่น ผู้ใช้จะรวมโทเค็นย่อยหลายอัน ๆ (คล้าย ๆ ระบบของ utxo นั่นแหละ) ให้เท่ากับจำนวนที่ต้องการ ซึ่งช่วยให้เหรียญแต่ละเหรียญมี anonymity set ใหญ่ขึ้น และยากที่ mint จะระบุตัวบุคคลจากข้อมูลจำนวนที่ไม่ซ้ำกันได้

เนื่องจากเป็นระบบในลักษณะ **custodial** ผู้ใช้จำเป็นต้องวางใจ mint โดยฝาก Bitcoin ไว้กับ mint ก่อนแลกเป็น e-cash ต่างจาก Lightning ที่มีทางเลือกทั้ง custodial และ non-custodial&#x20;

Cashu จะออกโทเค็นก็ต่อเมื่อได้รับชำระ Bitcoin จากผู้ใช้ก่อน และ mint จะเก็บ Bitcoin เหล่านั้นไว้เป็นสินทรัพย์สำรอง อย่างไรก็ตาม ข้อดีคือ mint จะ **ไม่รู้จำนวนเหรียญหรือยอดเงินคงเหลือในบัญชีผู้ใช้** ทำให้มีความเป็นส่วนตัวมากกว่าระบบการเงินทั่วไป ( mint ไม่รู้ว่าผู้ใช้คนใดถือโทเค็นอยู่หรือจ่ายให้ใคร) ผู้ใช้จึงได้ประโยชน์จากความเป็นส่วนตัวอย่างแท้จริง

### การทำงานร่วมกับ Bitcoin และ Lightning Network

โดยปกติผู้ใช้จะ **ฝาก Bitcoin ผ่าน Lightning Network** ให้กับ mint เพื่อนำมาออก e‑cash หลังจากนั้น mint จะออกโทเค็น e-cash ตามมูลค่านั้นทันที ผู้ใช้ถือโทเค็นนี้ไว้ในวอลเล็ต Cashu บนมือถือหรือเว็บเบราว์เซอร์ เพื่อใช้แทน Bitcoin ในการจ่ายเงินต่อไป โดยที่ไม่จำเป็นต้องใช้บล็อกเชนในการบันทึกอีก (ทำให้การโอนเป็นไปได้เร็วและไม่มีค่าธรรมเนียม หรือค่าธรรมเนียมต่ำ) ซึ่งแบ่งการส่งออกได้เป็น 3 แบบ

* **การโอนภายใน mint เดียวกัน** – เมื่อผู้รับและผู้ส่งเลือกใช้ mint เดียวกัน เงินจะถูกโอนผ่านระบบ e-cash กันโดยตรงทันที (peer-to-peer) โดยไม่มีค่าธรรมเนียม เนื่องจากระบบไม่ต้องทำธุรกรรมใด ๆ บนบล็อกเชน หรือไม่ต้องเปิดช่องทาง Lightning เพิ่ม
* **การโอนข้าม mint (inter-mint)** – หากผู้รับอยู่คนละ mint กัน Cashu จะใช้ **Lightning Network** เป็นทางเชื่อมสำหรับชำระหนี้ระหว่าง mint หรือก็คือ ผู้ส่งจะส่งโทเค็นไปยังวอลเล็ตของผู้รับ (ระบุผู้รับและ mint ปลายทาง) แล้วระบบจะให้ mint ผู้ส่งชำระ Bitcoin กับ mint ผู้รับผ่าน Lightning (เหมือนการโยกย้ายยอดภายในโครงข่าย) ทำให้การจ่ายเงินข้าม mint เกิดขึ้นได้อย่างรวดเร็วและปลอดภัย
* **การถอน (redeem)** – หากผู้ใช้ต้องการเปลี่ยนโทเค็น ให้กลับเป็น Bitcoin อีกครั้ง ก็สามารถทำได้ง่าย ๆ โดยส่งโทเค็นพร้อมมูลค่ากลับไปยัง mint แล้ว mint ตรวจสอบความถูกต้องแล้วจะจ่าย Bitcoin ให้ผู้ใช้ผ่าน Lightning Network ทันที

### สรุป

Cashu เป็นนวัตกรรมด้าน e-cash ที่นำเสนอวิธีการชำระเงินแบบ **ส่วนตัว รวดเร็ว** เหมือนการจ่ายด้วยเงินสดจริง โดยใช้หลัก **Chaumian blind signatures** ร่วมกับระบบ Bitcoin/Lightning Network และแม้ว่าการใช้ Cashu จะต้องฝาก Bitcoin ไว้กับ mint และยอมรับความเสี่ยงเชิงการดูแลเงิน (custody risk) แต่ระบบก็ออกแบบให้ผู้ใช้ไม่ต้องแสดงตัวตนหรือจัดการช่องทาง Lightning เอง ประโยชน์ที่ได้คือความเป็นส่วนตัวขั้นสูงและประสบการณ์การใช้งานที่ราบรื่น ผู้ใช้สามารถโอนเงินเล็ก ๆ ผ่าน Cashu ได้โดยไม่ต้องกังวลกับค่าธรรมเนียมหรือปัญหาสภาพคล่องแบบใน Lightning ปกติ

ในทางกลับกัน Cashu ยังต้องพัฒนาเพิ่มทั้งในเรื่องการยอมรับจากตลาด (ควรมีผู้ให้บริการ mint มากกว่านี้) และระบบรักษาความน่าเชื่อถือของ mint เพื่อให้แข็งแกร่งขึ้นในแง่ของความปลอดภัย ทั้งนี้ Cashu ได้พิสูจน์ให้เห็นถึงศักยภาพใหม่ของการผสานเทคโนโลยี e-cash เข้ากับ Bitcoin อย่างสร้างสรรค์ และคาดว่าจะเป็นอีกหนึ่งทางเลือกในการชำระเงินดิจิทัลที่ผู้ใช้สามารถเลือกใช้ตามความต้องการได้

### อ้างอิง

\[1] [https://cashu.space/](https://cashu.space/)

\[2] [https://blog.cashu.space/buckets-of-blind-signatures/](https://blog.cashu.space/buckets-of-blind-signatures/)
